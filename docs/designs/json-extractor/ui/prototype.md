# JSON Extractor - UI Prototype

## 实现顺序

```
CLI (Rust) → WASM → Web UI → Desktop → Tests
```

## 平台差异说明

| 功能 | Web | Desktop |
|------|-----|---------|
| JSON提取 | ✅ | ✅ |
| 路径语法帮助 | ✅ (Hover) | ✅ (Hover) |
| 输出格式化 | ✅ | ✅ |
| 复制/下载 | ✅ | ✅ |
| 历史记录 | ❌ | ✅ |
| 收藏路径 | ❌ | ✅ |
| 配置持久化 | ❌ | ✅ |
| 系统托盘 | ❌ | ✅ |

> **注意**：Web端无状态，所有数据不保存。Desktop端支持历史记录和收藏功能。

## 页面布局

### 桌面端

```
┌─────────────────────────────────────────────────────────────────┐
│  ShardDen > JSON 提取器 [?]                    [Theme ▼] [⚙] │
├─────────────┬───────────────────────────────────────────────────┤
│             │                                                   │
│  📁 工具    │   ┌─────────────────────┬─────────────────────┐ │
│             │   │  输入                 │  输出               │ │
│  ├ JSON  ✅ │   │                     │                     │ │
│    提取器    │   │  ┌───────────────┐  │  ┌───────────────┐  │ │
│             │   │  │               │  │  │               │  │ │
│  ├ URL      │   │  │   JSON 输入   │  │  │   提取结果   │  │ │
│    解析器    │   │  │   区域        │  │  │   区域       │  │ │
│             │   │  │               │  │  │               │  │ │
│  └ ...      │   │  │               │  │  │               │  │ │
│             │   │  └───────────────┘  │  └───────────────┘  │ │
│  ─────────  │   │                     │                     │ │
│  ⭐ 收藏    │   │  JSONPath: [______] │  格式: [JSON ▼]  │ │
│  ─────────  │   │                     │                     │ │
│  🕐 历史    │   │  [提取] [清空]     │  [复制] [下载]   │ │
│             │   │                     │                     │ │
└─────────────┴───┴─────────────────────┴─────────────────────┴─┘
```

### Web端（去掉收藏/历史/设置）

```
┌─────────────────────────────────────────────────────────────────┐
│  ShardDen > JSON 提取器 [?]                    [Theme ▼]      │
├─────────────┬───────────────────────────────────────────────────┤
│             │                                                   │
│  📁 工具    │   ┌─────────────────────┬─────────────────────┐ │
│             │   │  输入                 │  输出               │ │
│  ├ JSON  ✅ │   │                     │                     │ │
│    提取器    │   │  ┌───────────────┐  │  ┌───────────────┐  │ │
│             │   │  │               │  │  │               │  │ │
│  ├ URL      │   │  │   JSON 输入   │  │  │   提取结果   │  │ │
│    解析器    │   │  │   区域        │  │  │   区域       │  │ │
│             │   │  │               │  │  │               │  │ │
│  └ ...      │   │  │               │  │  │               │  │ │
│             │   │  └───────────────┘  │  └───────────────┘  │ │
│             │   │                     │                     │ │
│             │   │  JSONPath: [______] │  格式: [JSON ▼]    │ │
│             │   │                     │                     │ │
│             │   │  [提取] [清空]     │  [复制] [下载]     │ │
│             │   │                     │                     │ │
└─────────────┴───┴─────────────────────┴─────────────────────┴─┘
```

### 帮助按钮交互 [?]

Hover 显示 JSONPath 语法帮助：

```
  ┌─────────────────────────────────────┐
  │  JSONPath 语法帮助                      │
  ├─────────────────────────────────────┤
  │  key     → 获取对象属性                │
  │  *       → 通配符，匹配所有键           │
  │  [0]     → 数组索引                    │
  │  [:]     → 数组切片                    │
  │  [?(@.x)] → 过滤表达式                │
  │  ..      → 递归下降                    │
  └─────────────────────────────────────┘
```

### 移动端

```
┌─────────────────────────┐
│  JSON Extractor    [≡]  │
├─────────────────────────┤
│  Input JSON:            │
│  ┌───────────────────┐  │
│  │                   │  │
│  │   Paste JSON...   │  │
│  │                   │  │
│  └───────────────────┘  │
│                         │
│  Path(s): [__________]  │
│                         │
│  [   Extract   ]        │
│                         │
│  Output:                │
│  ┌───────────────────┐  │
│  │                   │  │
│  │   Result...       │  │
│  │                   │  │
│  └───────────────────┘  │
│                         │
│  [Copy]  [Download]     │
│                         │
│  [▼ Path Syntax Help]   │
└─────────────────────────┘
```

## 交互流程

### 主流程

1. **输入阶段**
   - 用户在左侧面板粘贴 JSON
   - 输入框自动检测 JSON 有效性
   - 有效时显示绿色边框，无效时显示红色边框

2. **路径输入**
   - 用户在路径输入框输入表达式
   - 支持多路径（逗号分隔）
   - 提供历史路径下拉建议

3. **执行提取**
   - 点击 "Extract" 按钮
   - 显示加载动画
   - WASM 调用执行提取
   - 结果显示在右侧面板

4. **结果处理**
   - 支持格式化切换（JSON/CSV/Text）
   - 复制到剪贴板
   - 下载为文件

### 错误处理

- **无效 JSON**: 输入框红色边框 + 底部错误提示
- **无效路径**: 路径框红色边框 + 建议路径列表
- **提取错误**: Toast 通知 + 详细错误信息
- **空结果**: 提示 "未找到匹配项"

### 快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl+Enter | 执行提取 |
| Ctrl+L | 清空输入 |
| Ctrl+C (output focused) | 复制结果 |
| Ctrl+D | 下载结果 |

## 组件清单

- `JsonInput` - JSON 输入区（带验证）
- `PathInput` - 路径输入（带建议）
- `OutputPanel` - 结果显示区（带格式化）
- `FormatSelector` - 格式选择器
- `ActionButtons` - 操作按钮组
- `HelpButton` - 帮助按钮（Hover 显示语法帮助）

## 状态管理

```typescript
interface ExtractorState {
  input: string;
  paths: string[];
  output: string;
  format: 'json' | 'csv' | 'text';
  isValid: boolean;
  isLoading: boolean;
  error: string | null;
  showHelp: boolean; // Help button hover state
}
```
